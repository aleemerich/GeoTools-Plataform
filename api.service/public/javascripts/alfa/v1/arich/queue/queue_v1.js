var ARICH=ARICH||{};ARICH.queue=function(){var e=[],t=[],n=[],r={queue:0,queue_execute:0,scripts:0},i=0,s=0,o=false,u=false;return{load:function(n,i){var s=n;switch(i){case"details":for(var o=0;o<s.length;o++){var u={};u.id=s[o]["id"];u.script_detail_id=s[o]["script_detail_id"];u.script_id=s[o]["script_id"];u.function_exec=s[o]["function_exec"];u.description=s[o]["description"];u.params=s[o]["params"];u.order=s[o]["order"];u.remote=s[o]["remote"];u.status="sleep";t.push(u)}r.queue=t.length;break;case"scripts":for(var o=0;o<s.length;o++){var a={};a.id=s[o]["id"];a.script_ids=s[o]["script_ids"];a.key_action=s[o]["key_action"];a.name=s[o]["name"];a.description=s[o]["description"];a.order=s[o]["order"];e.push(a)}r.scripts=e.length;break;default:console.log("[ARICH.queue.load] Tipo de dado a ser carregado não foi definido");break}},setExecute:function(a){var f=false,l;if(!o){if(this.triggerExecution(a)){for(l=0;l<t.length;l++){if(ARICH.helper.json.toObject(e[l]["key_action"]).indexOf(a)>=0){n=ARICH.helper.hashtable.slice(t,{script_id:e[l]["id"]});s=n.length;r.queue_execute=n.length;if(e[l]["script_ids"]!==null){var c=ARICH.helper.json.toObject(e[l]["script_ids"]),h;for(h=0;h<c.length;h++){n=n.concat(ARICH.helper.hashtable.slice(t,{script_id:c[h]}))}i=n.length}this.alterQueueExecute({status:"wait"});f=true;break}}}else{u=true;console.log("[ARICH.queue.setExecute] A key_action não existe")}}else{u=true;console.log("[ARICH.queue.setExecute] A fila está bloqueada")}return f},hasExecute:function(e){if(e!==undefined){s=ARICH.helper.hashtable.count(n,{status:"wait",order:e});return s>0}else{i=ARICH.helper.hashtable.count(n,{status:"wait"});return i>0}},getQueueExecute:function(e){return ARICH.helper.hashtable.slice(n,{order:e})},alterQueueExecute:function(e,t,r){switch(t){case"id":for(var i=0;i<n.length;i++){if(n[i]["id"]==r){for(var s in e){if(n[i][s]!==undefined){n[i][s]=e[s]}}}}break;case"order":for(var i=0;i<n.length;i++){if(n[i]["order"]===null){for(var s in e){if(n[i][s]!==undefined){n[i][s]=e[s]}}}}break;default:for(var i=0;i<n.length;i++){for(var s in e){if(n[i][s]!==undefined){n[i][s]=e[s]}}}break}},errorQueueExecute:function(e){u=true;console.log("[ARICH.queue.errorQueueExecute] Erro na execução de uma função da fila: "+e)},resetQueueExecute:function(){n=[];r.queue_execute=0;i=0;s=0;o=false;u=false;ARICH.composer.resetOrder()},errorInExecution:function(){return u},triggerExecution:function(t,n){var r=false,i;if(n!==undefined){for(i=0;i<e.length;i++){if(ARICH.helper.json.toObject(e[i][n]).indexOf(t)>=0){r=true;break}}}else{for(i=0;i<e.length;i++){if(ARICH.helper.json.toObject(e[i]["key_action"]).indexOf(t)>=0){r=true;break}}}return r},blocked:function(){o=true},unblocked:function(){o=false},isBlocked:function(){return o},queue:t,queue_execute:n,quantity_execute_now:i,quantity_execute_now_in_order:s,scripts:e}}()